# Обмен по технологии КД3, КД2, регистрация изменений

## КД2

ВыгрузитьПоПравилу()
	
```bsl

Если ЕстьГлобальныйОбработчикПередКонвертациейОбъекта Тогда
	...
КонецЕсли;

Если ПКО.ЕстьОбработчикПередВыгрузкой Тогда
	...
КонецЕсли;

ВыгрузитьСвойства();

Если ПКО.ЕстьОбработчикПриВыгрузке Тогда
	...
КонецЕсли

ВыгрузитьСвойства();

Если ПКО.ЕстьОбработчикПослеВыгрузки Тогда
	...
КонецЕсли;

Если ПКО.ЕстьОбработчикПослеВыгрузкиВФайл Тогда
	...
КонецЕсли;

```

ПрочитатьОбъект()

```bsl

//Доступен объект ФайлОбмена типа ЧтениеXML

Пока ФайлОбмена.Прочитать() Цикл

	Если ИмяУзла = "Свойство"
		ИЛИ ИмяУзла = "ЗначениеПараметра" Тогда

		Значение = ПрочитатьСвойство(ТипСвойства, ИмяПКО);
			НужноПродолжитьПоискЕслиЭлементПоGUIDНеНайден = Истина|Ложь;
			-> НайтиИлиСоздатьОбъектПоСвойству()
				-> НайтиОбъектПоСвойству();
					-> ПроверитьСуществованиеСсылки();
	
	
	ИначеЕсли ИмяУзла = "Ссылка" Тогда
		Ссылка = НайтиОбъектПоСсылке(...);

		Если ЕстьОбработчикПриЗагрузке Тогда
			...
		КонецЕсли;

	ИначеЕсли ИмяУзла = "ТабличнаяЧасть"
		ИЛИ ИмяУзла = "НаборЗаписей" Тогда

	ИначеЕсли (ИмяУзла = "Объект") И (ФайлОбмена.ТипУзла = одТипУзлаXML_КонецЭлемента) Тогда

		Если ЕстьГлобальныйОбработчикПослеЗагрузкиОбъекта Тогда
		КонецЕсли;

		Если ЕстьОбработчикПослеЗагрузки Тогда
		КонецЕсли;


	КонецЕсли;

КонецЦикла;

Если ЕстьГлобальныйОбработчикПослеЗагрузкиОбъекта Тогда 
	...
КонецЕсли;

Если ЕстьОбработчикПослеЗагрузки Тогда
	...
КонецЕсли;

```
